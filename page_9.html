<!DOCTYPE html>
<html lang="pt">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Auditoria Manual - Verdade Terrestre</title>

    <script src="https://cdn.tailwindcss.com"></script>

    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />

    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;800&family=Open+Sans:wght@400;600&display=swap"
      rel="stylesheet"
    />

    <script src="https://d3js.org/d3.v7.min.js"></script>

    <style>
      body {
        width: 1280px;
        height: 720px;
        overflow: hidden;
        background: linear-gradient(135deg, #e0f2f1 0%, #eceff1 100%);
        font-family: "Open Sans", sans-serif;
        margin: 0;
        padding: 0;
      }

      .glass-panel {
        background: rgba(255, 255, 255, 0.85);
        backdrop-filter: blur(12px);
        border-radius: 16px;
        box-shadow: 0 8px 32px rgba(31, 38, 135, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.4);
        height: 100%;
      }

      .title-gradient {
        background: linear-gradient(90deg, #19747e, #26a69a);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
      }

      /* Estilos Específicos do Gráfico D3 */
      .master-line {
        stroke: #19747e;
        stroke-width: 6;
        stroke-linecap: round;
      }
      .feature-line {
        fill: none;
        stroke-width: 4;
        stroke-dasharray: 1000;
        stroke-dashoffset: 1000;
        animation: drawLine 2s forwards ease-in-out;
      }
      .commit-dot {
        fill: white;
        stroke: #19747e;
        stroke-width: 2;
      }
      .merge-dot {
        fill: #19747e;
        stroke: white;
        stroke-width: 2;
      }

      @keyframes drawLine {
        to {
          stroke-dashoffset: 0;
        }
      }
    </style>
  </head>
  <body class="p-10 flex flex-col relative">
    <div class="mb-6">
      <h1
        class="text-4xl font-extrabold font-montserrat title-gradient mb-2 py-2 leading-tight"
      >
        Auditoria Manual: Verdade Terrestre
      </h1>
      <div class="w-24 h-2 bg-teal-600 rounded-full"></div>
      <p class="text-gray-500 mt-2 text-lg">
        Análise humana do fluxo real (15 Nov - 15 Dez)
      </p>
    </div>

    <div class="flex gap-8 h-full pb-8">
      <div class="w-1/3 flex flex-col gap-5">
        <div
          class="glass-panel p-6 border-l-4 border-red-500 flex flex-col justify-center"
        >
          <div class="flex items-center mb-2">
            <i class="fas fa-network-wired text-2xl text-red-500 mr-3"></i>
            <h3 class="text-xl font-bold text-gray-800">Topologia</h3>
          </div>
          <p class="text-gray-700">
            <strong class="text-red-600">Inexistência</strong> de branch
            <code>develop</code>. Todas as features saem e voltam para a
            <code>master</code>.
          </p>
        </div>

        <div
          class="glass-panel p-6 border-l-4 border-yellow-500 flex flex-col justify-center"
        >
          <div class="flex items-center mb-2">
            <i class="fas fa-tachometer-alt text-2xl text-yellow-500 mr-3"></i>
            <h3 class="text-xl font-bold text-gray-800">Volume</h3>
          </div>
          <div class="text-4xl font-extrabold text-gray-800 mb-1">58 PRs</div>
          <p class="text-sm text-gray-500">
            Mesclados em apenas 1 mês (Alta Frequência).
          </p>
        </div>

        <div
          class="glass-panel p-6 border-l-4 border-teal-600 bg-teal-50 flex flex-col justify-center"
        >
          <div class="flex items-center mb-2">
            <i class="fas fa-check-circle text-2xl text-teal-600 mr-3"></i>
            <h3 class="text-xl font-bold text-teal-800">Conclusão</h3>
          </div>
          <p class="text-lg font-bold text-gray-800">GitHub Flow</p>
          <p class="text-xs text-gray-600">Ciclos curtos + CI Intenso.</p>
        </div>
      </div>

      <div class="w-2/3 glass-panel relative bg-white/60 p-4">
        <h3
          class="absolute top-4 left-6 text-gray-400 font-bold uppercase text-xs tracking-widest"
        >
          Visualização do Fluxo Identificado
        </h3>
        <div
          id="viz-container"
          class="w-full h-full flex items-center justify-center"
        ></div>
      </div>
    </div>

    <div
      class="absolute bottom-6 right-10 text-gray-400 font-bold text-xl opacity-60"
    >
      09
    </div>

    <script>
      const width = 750;
      const height = 450;

      const svg = d3
        .select("#viz-container")
        .append("svg")
        .attr("viewBox", `0 0 ${width} ${height}`)
        .attr("width", "100%")
        .attr("height", "100%");

      // 1. Linha Mestra (Timeline)
      const masterY = height / 2;

      svg
        .append("line")
        .attr("x1", 50)
        .attr("y1", masterY)
        .attr("x2", width - 50)
        .attr("y2", masterY)
        .attr("class", "master-line");

      svg
        .append("text")
        .attr("x", 20)
        .attr("y", masterY + 5)
        .attr("font-weight", "bold")
        .attr("fill", "#19747E")
        .attr("font-family", "Montserrat")
        .text("main");

      // 2. Dados das Feature Branches
      const features = [
        {
          start: 100,
          end: 250,
          type: "feat",
          label: "feat/rag-engine",
          color: "#F59E0B",
        }, // Laranja
        {
          start: 200,
          end: 350,
          type: "fix",
          label: "fix/docker-build",
          color: "#EF4444",
        }, // Vermelho
        {
          start: 400,
          end: 550,
          type: "feat",
          label: "feat/ui-update",
          color: "#F59E0B",
        },
        {
          start: 500,
          end: 650,
          type: "feat",
          label: "feat/api-v2",
          color: "#8B5CF6",
        }, // Roxo
      ];

      // 3. Desenhar as Features
      features.forEach((feat, i) => {
        const offset = i % 2 === 0 ? -70 : 70; // Alterna cima/baixo
        const midX = (feat.start + feat.end) / 2;
        const curveY = masterY + offset;

        // Caminho da linha (Curva Bézier)
        const pathData = `M ${feat.start} ${masterY} 
                              Q ${feat.start + 30} ${curveY} ${midX} ${curveY} 
                              Q ${feat.end - 30} ${curveY} ${
          feat.end
        } ${masterY}`;

        // Linha Colorida
        svg
          .append("path")
          .attr("d", pathData)
          .attr("class", "feature-line")
          .style("stroke", feat.color)
          .style("animation-delay", `${i * 0.6}s`);

        // Dot Inicial
        svg
          .append("circle")
          .attr("cx", feat.start)
          .attr("cy", masterY)
          .attr("r", 5)
          .attr("class", "commit-dot");

        // Dot Final (Merge)
        svg
          .append("circle")
          .attr("cx", feat.end)
          .attr("cy", masterY)
          .attr("r", 7)
          .attr("class", "merge-dot")
          .style("opacity", 0)
          .transition()
          .delay(1200 + i * 600)
          .duration(400)
          .style("opacity", 1);

        // Label
        svg
          .append("text")
          .attr("x", midX)
          .attr("y", curveY + (offset > 0 ? 20 : -10))
          .attr("text-anchor", "middle")
          .attr("font-size", "12px")
          .attr("font-weight", "600")
          .attr("fill", "#555")
          .text(feat.label)
          .style("opacity", 0)
          .transition()
          .delay(800 + i * 600)
          .duration(500)
          .style("opacity", 1);
      });
    </script>
  </body>
</html>
